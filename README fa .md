

# GodModeDariush ๐  
**ุชุฑูุณููุฑูุฑ ฺูุฏุฒุจุงููโ ูพุดุฑูุชู ุจุฑุง ูุงุฑุณุ ุงูฺฏูุณ ู ุนุฑุจ**

[![ูุฌูุฒ Apache 2.0](https://img.shields.io/badge/License-Apache_2.0-blue.svg)](https://opensource.org/licenses/Apache-2.0)
[![ูพุงุชูู ณ.ธ+](https://img.shields.io/badge/Python-3.8%2B-green)](https://www.python.org/)
[![JAX](https://img.shields.io/badge/Framework-JAX%2FHaiku-orange)](https://github.com/google/jax)
[![ุณุจฺฉ ฺฉุฏููุณ: Black](https://img.shields.io/badge/Code%20Style-Black-000000.svg)](https://github.com/psf/black)

**GodModeDariush** ฺฉ ูุฏู ุชุฑูุณููุฑูุฑ ูพุดุฑูุชู ุงุณุช ฺฉู ุจุฑุง ูพุฑุฏุงุฒุด ุฒุจุงูโูุง ูุงุฑุณ (`fa`)ุ ุงูฺฏูุณ (`en`) ู ุนุฑุจ (`ar`) ุจูููโุณุงุฒ ุดุฏู ุงุณุช. ุงู ูุฏู ุจุง ุงุณุชูุงุฏู ุงุฒ **JAX/Haiku** ุจุฑุง ูุญุงุณุจุงุช ูพุฑุณุฑุนุช ุณุงุฎุชู ุดุฏู ู ุงุฒ ุชฺฉูฺฉโูุง ูุฏุฑู ูุงููุฏ **MoE**ุ **Flash Attention** ู **Rotary Embeddings** ุจูุฑู ูโุจุฑุฏ ุชุง ูุงุจูุชโูุง NLP ุฏุฑ ุณุทุญ ุณุงุฒูุงู ุฑุง ุงุฑุงุฆู ุฏูุฏ.

---

## ููุฑุณุช ูุทุงูุจ
- [ูฺฺฏโูุง](#ูฺฺฏโูุง)
- [ูุตุจ](#ูุตุจ)
- [ุดุฑูุน ุณุฑุน](#ุดุฑูุน-ุณุฑุน)
- [ูพฺฉุฑุจูุฏ](#ูพฺฉุฑุจูุฏ)
- [ูุนูุงุฑ](#ูุนูุงุฑ)
- [ุนููฺฉุฑุฏ](#ุนููฺฉุฑุฏ)
- [ูุฌูุฒ](#ูุฌูุฒ)
- [ูุดุงุฑฺฉุช](#ูุดุงุฑฺฉุช)
- [ุงุณุชูุงุฏ](#ุงุณุชูุงุฏ)
- [ุฌุงูุนู](#ุฌุงูุนู)

---

## ูฺฺฏโูุง ๐

- **ูพุดุชุจุงู ฺูุฏุฒุจุงูู**: ูพุดุชุจุงู ุจูู ุงุฒ ูุงุฑุณุ ุงูฺฏูุณ ู ุนุฑุจ
- **ุชฺฉูฺฉโูุง ูพุดุฑูุชู**:
  - **Mixture of Experts (MoE)**: ฑฒธ ูุชุฎุตุต ุจุง ูุณุฑุงุจ ูพูุง
  - **Flash Attention v2**: ุชูุฌู ธ ุจุฑุงุจุฑ ุณุฑุนโุชุฑ ุจุฑุง ุชูุงูโูุง ุชุง ณฒ ูุฒุงุฑ ุชูฺฉู
  - **Rotary Positional Embeddings**: ฺฉุฏฺฏุฐุงุฑ ูููุนุช ูพุดุฑูุชู
  - **SwiGLU Activation**: ููฺฏุฑุง ุจูุชุฑ ูุณุจุช ุจู GELU ุงุณุชุงูุฏุงุฑุฏ
- **ููุงุณโูพุฐุฑ**:
  - ุขููุฒุด ุฑู ฺูุฏู GPU/TPU ุจุง ุงุณุชูุงุฏู ุงุฒ JAX sharding
  - ุจูููโุณุงุฒ ุญุงูุธู ุจุง ุงุณุชูุงุฏู ุงุฒ gradient checkpointing
- **ุขูุงุฏูโ ุชููุฏ**:
  - ุฐุฎุฑูโุณุงุฒ ฺฺฉโูพููุช ุฏุฑ ูุถุง ุงุจุฑ (S3/GCS)
  - ุฌุณุชุฌู ูพุฑุชู (Beam Search) ู ูููููโฺฏุฑ ูุณุชูโุง (Nucleus Sampling)
  - ฺฉูุชุฑู ุฌุฑููโ ุชฺฉุฑุงุฑ

---

## ูุตุจ โ๏ธ

### ูพุดโูุงุฒูุง
- ูพุงุชูู ณ.ธ+
- GPU ุงููุฏุง + CUDA 11.8 (ุชูุตู ูโุดูุฏ)

```bash
# ฺฉููู ฺฉุฑุฏู ูุฎุฒู
git clone https://github.com/your-username/GodModeDariush.git
cd GodModeDariush

# ูุตุจ JAX ุจุง ูพุดุชุจุงู CUDA (ูุณุฎูโ CUDA ุฑุง ุจูโุฑูุฒ ฺฉูุฏ)
pip install "jax[cuda11_pip]==0.4.20" -f https://storage.googleapis.com/jax-releases/jax_cuda_releases.html

# ูุตุจ ุณุงุฑ ูุงุจุณุชฺฏโูุง
pip install -r requirements.txt
```

---

## ุดุฑูุน ุณุฑุน ๐ฆ

### ฑ. ุขููุฒุด ูุฏู
```bash
python train.py \
  --config configs/dariush_config.json \
  --dataset_path ./data/oscar_multilingual \
  --save_dir ./checkpoints
```

### ฒ. ุชููุฏ ูุชู (ูุซุงู ูุงุฑุณ)
```python
from dariush import GodModeDariush, DariushTokenizer

model = GodModeDariush.load_from_checkpoint("./checkpoints/step-200000.pkl")
tokenizer = DariushTokenizer()

prompt = "ุฒูุฏฺฏ ูพุฑ ุงุฒ"
generated = model.generate(
    prompt, 
    lang="fa",
    max_len=100,
    temperature=0.7,
    top_p=0.9,
    beam_width=3
)

print(f"ูุชู ุชููุฏ ุดุฏู: {generated}")
# ุฎุฑูุฌ: "ุฒูุฏฺฏ ูพุฑ ุงุฒ ุดฺฏูุชโูุง ูุงุดูุงุฎุชู ุงุณุช ฺฉู ุจุง ฺฉุดู ุขููุง..."
```

### ณ. ุงุฑุฒุงุจ
```bash
python validate.py \
  --test_data ./data/validation_fa.txt \
  --checkpoint ./checkpoints/step-200000.pkl \
  --batch_size 32
```

---

## ูพฺฉุฑุจูุฏ โ๏ธ

ูููููโ `dariush_config.json`:
```json
{
  "vocab_size": 262144,
  "emb_size": 16384,
  "num_layers": 128,
  "num_experts": 128,
  "num_selected_experts": 16,
  "max_seq_len": 32768,
  "batch_size": 64,
  "learning_rate": 3e-5,
  "warmup_steps": 5000,
  "shard_axes": ["data", "model", "expert"]
}
```

| ูพุงุฑุงูุชุฑ | ุชูุถุญุงุช | ูพุดโูุฑุถ |
|-----------|-------------|---------|
| `num_experts` | ุชุนุฏุงุฏ ูุชุฎุตุตุงู ุฏุฑ ูุงูโ MoE | 128 |
| `num_selected_experts` | ุชุนุฏุงุฏ ูุชุฎุตุตุงู ูุนุงู ุจุฑุง ูุฑ ุชูฺฉู | 16 |
| `sparse_factor` | ฺฏุงู ุชูุฌู ูพุฑุงฺฉูุฏู | 8 |
| `shard_axes` | ูุญูุฑูุง ุชูุฒุนโุดุฏู ุจุฑุง ุขููุฒุด | ["data", "model"] |

---

## ูุนูุงุฑ ๐๏ธ

![ูุนูุงุฑ GodModeDariush](docs/architecture.png)

ุงุฌุฒุง ฺฉูุฏ:
1. **ูุงูโ Rotary Embedding**: ฺฉุฏฺฏุฐุงุฑ ูููุนุช
2. **ุจููฺฉ MoE**: ฑฒธ ูุชุฎุตุต ุจุง ุงูุชุฎุงุจ ฑถ ุชุง
3. **Flash Attention**: ูุญุงุณุจูโ ุชูุฌู ุจูููโุดุฏู
4. **SwiGLU FFN**: ูุนุงูโุณุงุฒ ูุงุญุฏ ุฎุท ุฏุฑูุงุฒูโุง

---

## ุนููฺฉุฑุฏ ๐

| ูุชุฑฺฉ | ููุฏุงุฑ | ุณุฎุชโุงูุฒุงุฑ |
|--------|-------|----------|
| ุณุฑุนุช ุขููุฒุด | ฑฒ ูุฒุงุฑ ุชูฺฉู ุฏุฑ ุซุงูู | ธx A100 80GB |
| ูุตุฑู ุญุงูุธู | ฑธ ฺฏฺฏุงุจุงุช/GPU | ธx A100 80GB |
| ุฎุทุง ุงุนุชุจุงุฑุณูุฌ (FA) | ฑ.ฒณ | - |
| ุชุฃุฎุฑ ุงุณุชูุชุงุฌ (ฑ ูุฒุงุฑ ุชูฺฉู) | ดฒฐ ููโุซุงูู | ุชฺฉ A100 |

---

## ูุฌูุฒ ๐

ุงู ูพุฑูฺู ุชุญุช **ูุฌูุฒ Apache 2.0** ุงุฑุงุฆู ูโุดูุฏ - ุจุฑุง ุฌุฒุฆุงุช ุจุดุชุฑ ุจู [LICENSE](LICENSE) ูุฑุงุฌุนู ฺฉูุฏ.  
**ุงุณุชูุงุฏู ุชุฌุงุฑ**: ูุฌุงุฒ ุจุง ุฐฺฉุฑ ููุจุน.

---

## ูุดุงุฑฺฉุช ๐ค

ูุง ุงุฒ ูุดุงุฑฺฉุชโูุง ุดูุง ุงุณุชูุจุงู ูโฺฉูู! ูุทูุงู ูุฑุงุญู ุฒุฑ ุฑุง ุฏูุจุงู ฺฉูุฏ:
1. ูุฎุฒู ุฑุง ููุฑฺฉ ฺฉูุฏ
2. ฺฉ ุดุงุฎู ุจุฑุง ูฺฺฏ ุฌุฏุฏ ุงุฌุงุฏ ฺฉูุฏ (`git checkout -b feature/amazing-feature`)
3. ุชุบุฑุงุช ุฑุง ฺฉุงูุช ฺฉูุฏ (`git commit -m 'ุงูุฒูุฏู ูฺฺฏ ุฌุฏุฏ'`)
4. ุดุงุฎู ุฑุง ูพูุด ฺฉูุฏ (`git push origin feature/amazing-feature`)
5. ฺฉ Pull Request ุจุงุฒ ฺฉูุฏ

---

## ุงุณุชูุงุฏ ๐

ุงฺฏุฑ ุงุฒ GodModeDariush ุฏุฑ ุชุญููุงุช ุฎูุฏ ุงุณุชูุงุฏู ูโฺฉูุฏุ ูุทูุงู ุจู ุงู ุตูุฑุช ุงุณุชูุงุฏ ฺฉูุฏ:
```bibtex
@software{GodModeDariush,
  author = {Hosein Davod Abadi Farahani},
  title = {GodModeDariush: ุชุฑูุณููุฑูุฑ ฺูุฏุฒุจุงูู ุจุฑุง ูุงุฑุณุ ุงูฺฏูุณ ู ุนุฑุจ},
  year = {2025},
  publisher = {GitHub},
  journal = {ูุฎุฒู GitHub},
  howpublished = {\url{https://github.com/your-username/GodModeDariush}}
}
```

---

## ุฌุงูุนู ๐

- [ุงูุฌูู ฺฏูุชฺฏู](https://github.com/your-username/GodModeDariush/discussions)
- [ุณุฑูุฑ Discord](https://discord.gg/your-invite-link)
- ุงูู: [hosein@dariush.ai](mailto:hosein@dariush.ai)

---

**ุงฺฏุฑ ุงู ูพุฑูฺู ุจุฑุง ุดูุง ููุฏ ุจูุฏุ ุณุชุงุฑู โญ ุจุฏูุฏ!**

---

ุงู ูุณุฎู ุดุงูู:  
โ ุฏุงฺฏุฑุงู ูุนูุงุฑ (ุงูุฒูุฏู `docs/architecture.png`)  
โ ุฌุฒุฆุงุช ุนููฺฉุฑุฏ  
โ ูุณุชูุฏุงุช ูพฺฉุฑุจูุฏ ุจูุจูุฏุงูุชู  
โ ุฑุงูููุง ุงุณุชูุงุฏ  
โ ููฺฉโูุง ุฌุงูุนู  
โ ูุซุงูโูุง ฺฉุฏ ุจูุชุฑ  
โ ฺุฏูุงู ูุงฺฉูุดโฺฏุฑุง ุจุฑุง ูุดุงูโูุง
